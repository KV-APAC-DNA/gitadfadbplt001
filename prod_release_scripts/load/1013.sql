create or replace TABLE PROD_DNA_LOAD.PCFSDL_RAW.PCFSDL_LOAD__SDL_RF_VALUATION_REPORT_HISTORY (
	ACTUAL_QTY NUMBER(38,5),
	ACTUAL_GTS NUMBER(38,7),
	ACTUAL_NTS NUMBER(38,7),
	APO_BASE_FRCST NUMBER(29,3),
	APO_PROMO_FRCST NUMBER(29,3),
	APO_TOT_FRCST NUMBER(29,3),
	APO_GTS NUMBER(38,12),
	BAR_CD VARCHAR(40),
	BASE_PROD_CD VARCHAR(10),
	BASE_PROD_DESC VARCHAR(100),
	BRAND_SC VARCHAR(55),
	BRANDCON_MAPPING_FINAL VARCHAR(255),
	BRANDCON_MAPPING_SUMMARY VARCHAR(255),
	BP_GTS NUMBER(38,7),
	BP_NTS NUMBER(38,7),
	BP_QTY NUMBER(38,7),
	BRND_CD VARCHAR(10),
	BRND_DESC VARCHAR(100),
	CMP_ID VARCHAR(20),
	COUNTRY VARCHAR(20),
	CUST_CURR_CD VARCHAR(16777216),
	EXCH_RATE NUMBER(15,5),
	FRAN_CD VARCHAR(18),
	FRAN_DESC VARCHAR(100),
	GMC_SKU_CODE VARCHAR(16777216),
	GMC_SKU_NAME VARCHAR(16777216),
	UNIQUE_ID VARCHAR(16777216),
	GMC_REGION VARCHAR(16777216),
	GMC_CD VARCHAR(16777216),
	GMC_DESCRIPTION VARCHAR(16777216),
	GMC_CODE VARCHAR(16777216),
	GMC_SUBCATEGORY_CODE VARCHAR(16777216),
	GMC_SUBCATEGORY_NAME VARCHAR(16777216),
	GMC_LABEL_BRAND_CODE VARCHAR(16777216),
	GMC_LABEL_BRAND_NAME VARCHAR(16777216),
	GMC_LABEL_SUBBRAND_CODE VARCHAR(16777216),
	GMC_LABEL_SUBBRAND_NAME VARCHAR(16777216),
	GMC_VARIANT_CODE VARCHAR(16777216),
	GMC_VARIANT_NAME VARCHAR(16777216),
	GMC_SUBVARIANT_CODE VARCHAR(16777216),
	GMC_SUBVARIANT_NAME VARCHAR(16777216),
	GMC_FLAVOR_CODE VARCHAR(16777216),
	GMC_FLAVOR_NAME VARCHAR(16777216),
	GMC_INGREDIENT_CODE VARCHAR(16777216),
	GMC_INGREDIENT_NAME VARCHAR(16777216),
	GMC_APPLICATION_CODE VARCHAR(16777216),
	GMC_APPLICATION_NAME VARCHAR(16777216),
	GMC_LENGTH_STRENGTH_CODE VARCHAR(16777216),
	GMC_LENGTH_STRENGTH_NAME VARCHAR(16777216),
	GMC_SHAPE_CODE VARCHAR(16777216),
	GMC_SHAPE_NAME VARCHAR(16777216),
	GMC_SPF_CONCENTRATION_CODE VARCHAR(16777216),
	GMC_SPF_CONCENTRATION_NAME VARCHAR(16777216),
	GMC_COVER_PRODUCT_TYPE_CODE VARCHAR(16777216),
	GMC_COVER_PRODUCT_TYPE_NAME VARCHAR(16777216),
	GMC_FORM_CODE VARCHAR(16777216),
	GMC_FORM_NAME VARCHAR(16777216),
	GMC_SIZE_CODE VARCHAR(16777216),
	GMC_SIZE_NAME VARCHAR(16777216),
	GMC_CHARACTERS_SPECIAL_EDITION_CODE VARCHAR(16777216),
	GMC_CHARACTERS_SPECIAL_EDITION_NAME VARCHAR(16777216),
	GMC_PACKAGE_CODE VARCHAR(16777216),
	GMC_PACKAGE_NAME VARCHAR(16777216),
	GMC_UOM_CODE VARCHAR(16777216),
	GMC_UOM_NAME VARCHAR(16777216),
	P4_BRAND_CATEGORY_CODE VARCHAR(16777216),
	P4_BRAND_CATEGORY VARCHAR(16777216),
	B2_SUB_BRAND_CODE VARCHAR(16777216),
	B2_SUB_BRAND VARCHAR(16777216),
	C5_SUB_CATEGORY_CODE VARCHAR(16777216),
	C5_SUB_CATEGORY VARCHAR(16777216),
	C1_BUSINESS_SEGMENT_CODE VARCHAR(16777216),
	C1_BUSINESS_SEGMENT VARCHAR(16777216),
	C2_BUSINESS_SUBSEGMENT_CODE VARCHAR(16777216),
	C2_BUSINESS_SUBSEGMENT VARCHAR(16777216),
	C3_NEED_STATE_CODE VARCHAR(16777216),
	C3_NEED_STATE VARCHAR(16777216),
	C4_CATEGORY_CODE VARCHAR(16777216),
	C4_CATEGORY VARCHAR(16777216),
	C5_SUBCATEGORY_CODE VARCHAR(16777216),
	C5_SUBCATEGORY VARCHAR(16777216),
	B1_BRAND_CODE VARCHAR(16777216),
	B1_BRAND VARCHAR(16777216),
	B2_SUBBRAND_CODE VARCHAR(16777216),
	B2_SUBBRAND VARCHAR(16777216),
	P1_CODE VARCHAR(16777216),
	P1_BUSINESS_SEGMENT VARCHAR(16777216),
	PS_CODE VARCHAR(16777216),
	PS_BUSINESS_SUBSEGMENT VARCHAR(16777216),
	P2_CODE VARCHAR(16777216),
	P2_NEED_STATE VARCHAR(16777216),
	P3_CODE VARCHAR(16777216),
	P3_BRAND_CATEGORY VARCHAR(16777216),
	P4_CODE VARCHAR(16777216),
	P4_BRAND_CATEGORY_PLACEHOLDER VARCHAR(16777216),
	GOAL_GTS NUMBER(38,7),
	GOAL_NTS NUMBER(38,7),
	GOAL_QTY NUMBER(30,0),
	GRP_FRAN_CD VARCHAR(18),
	GRP_FRAN_DESC VARCHAR(100),
	JJ_MNTH NUMBER(18,0),
	JJ_MNTH_SHRT VARCHAR(3),
	JJ_PERIOD NUMBER(18,0),
	JJ_QRTR NUMBER(18,0),
	JJ_YEAR NUMBER(18,0),
	JU_GTS NUMBER(38,7),
	JU_NTS NUMBER(38,7),
	JU_QTY NUMBER(38,7),
	LIST_PRICE NUMBER(36,10),
    LIST_PRICE_NEW NUMBER(36,10),
	VALID_TO VARCHAR(16777216),
	DT_FROM VARCHAR(16777216),
	MASTER_CODE VARCHAR(18),
	MATL_DESC VARCHAR(100),
	MATL_ID VARCHAR(40),
	MATL_TYPE_CD VARCHAR(10),
	MATL_TYPE_DESC VARCHAR(40),
	MEGA_BRND_CD VARCHAR(10),
	MEGA_BRND_DESC VARCHAR(100),
	PAC_SOURCE_TYPE VARCHAR(6),
	PAC_SUBSOURCE_TYPE VARCHAR(18),
	PARENT_MATL_ID VARCHAR(18),
	PARENT_MATL_DESC VARCHAR(100),
	PLN_CNNL_CD VARCHAR(16777216),
	HARMONIZED_PLANNING_CHANNEL_DESC VARCHAR(16777216),
	POST_CD VARCHAR(150),
	PROD_FRAN_CD VARCHAR(18),
	PROD_FRAN_DESC VARCHAR(100),
	PROD_HIER_CD VARCHAR(40),
	PROD_HIER_DESC VARCHAR(100),
	PROD_MJR_CD VARCHAR(18),
	PROD_MJR_DESC VARCHAR(100),
	PROD_MNR_CD VARCHAR(18),
	PROD_MNR_DESC VARCHAR(100),
	NU_GTS NUMBER(38,7),
	NU_NTS NUMBER(38,7),
	NU_QTY NUMBER(38,7),
	PROJECTED_NTS NUMBER(38,7),
	PROJECTED_QTY NUMBER(38,5),
	PROJECTED_GTS NUMBER(38,7),
	PX_GTS NUMBER(38,7),
	PX_NTS NUMBER(38,7),
	PX_QTY NUMBER(38,0),
	SALES_GRP_DESC VARCHAR(30),
	STRONGHOLD_V3 VARCHAR(55),
	UPDATE_DATE DATE,
	CURRENT_JJ_MONTH NUMBER(18,0),
	CURRENT_JJ_YEAR NUMBER(18,0)
);
 
 
COPY INTO PROD_DNA_LOAD.PCFSDL_RAW.PCFSDL_LOAD__SDL_RF_VALUATION_REPORT
(
  ACTUAL_GTS,
  ACTUAL_NTS,
  ACTUAL_QTY,
  APO_GTS,
  APO_TOT_FRCST,
  BAR_CD,
  BASE_PROD_CD,
  BASE_PROD_DESC,
  BP_GTS,
  BP_NTS,
  BP_QTY,
  BRAND_SC,
  BRANDCON_MAPPING_FINAL,
  BRANDCON_MAPPING_SUMMARY,
  BRND_CD,
  BRND_DESC,
  CMP_ID,
  COUNTRY,
  CUST_CURR_CD,
  EXCH_RATE,
  FRAN_CD,
  FRAN_DESC,
  GOAL_GTS,
  GOAL_NTS,
  GOAL_QTY,
  GRP_FRAN_CD,
  GRP_FRAN_DESC,
  JJ_MNTH,
  JJ_MNTH_SHRT,
  JJ_PERIOD,
  JJ_QRTR,
  JJ_YEAR,
  JU_GTS,
  JU_NTS,
  JU_QTY,
  LIST_PRICE,
  LIST_PRICE_NEW,
  MASTER_CODE,
  MATL_ID,
  MATL_DESC,
  MATL_TYPE_CD,
  MATL_TYPE_DESC,
  MEGA_BRND_CD,
  MEGA_BRND_DESC,
  PAC_SOURCE_TYPE,
  PAC_SUBSOURCE_TYPE,
  PARENT_MATL_ID,
  PARENT_MATL_DESC,
  PLN_CNNL_CD,
  HARMONIZED_PLANNING_CHANNEL_DESC,
  POST_CD,
  PROD_FRAN_CD,
  PROD_FRAN_DESC,
  PROD_HIER_CD,
  PROD_HIER_DESC,
  PROD_MJR_CD,
  PROD_MNR_CD,
  PROD_MNR_DESC,
  PROD_MJR_DESC,
  PROJECTED_GTS,
  PROJECTED_NTS,
  PROJECTED_QTY,
  PX_GTS,
  PX_NTS,
  PX_QTY,
  SALES_GRP_DESC,
  STRONGHOLD_V3,
  UPDATE_DATE,
  CURRENT_JJ_MONTH,
  CURRENT_JJ_YEAR
)
FROM @PROD_DNA_LOAD.THASDL_RAW.PROD_LOAD_STAGE_ADLS/prd/eCOM_Data/transaction/rf_valuation/
FILE_FORMAT = (TYPE = CSV FIELD_DELIMITER = ','  SKIP_HEADER = 1 FIELD_OPTIONALLY_ENCLOSED_BY = '\"' ENCODING = 'ISO-8859-1');
 
 
copy into  PROD_DNA_LOAD.PCFSDL_RAW.PCFSDL_LOAD__SDL_RF_VALUATION_REPORT
(
  APO_TOT_FRCST,
  BAR_CD,
  BASE_PROD_CD,
  BASE_PROD_DESC,
  BRND_CD,
  BRND_DESC,
  CMP_ID,
  COUNTRY,
  PLN_CNNL_CD,
  HARMONIZED_PLANNING_CHANNEL_DESC,
  FRAN_CD,
  FRAN_DESC,
  GRP_FRAN_CD,
  GRP_FRAN_DESC,
  JJ_MNTH,
  JJ_MNTH_SHRT,
  JJ_PERIOD,
  JJ_QRTR,
  JJ_YEAR,
  MASTER_CODE,
  MATL_ID,
  MATL_DESC,
  MATL_TYPE_CD,
  MATL_TYPE_DESC,
  MEGA_BRND_CD,
  MEGA_BRND_DESC,
  PAC_SOURCE_TYPE,
  PAC_SUBSOURCE_TYPE,
  PARENT_MATL_ID,
  PARENT_MATL_DESC,
  POST_CD,
  PROD_FRAN_CD,
  PROD_FRAN_DESC,
  PROD_HIER_CD,
  PROD_HIER_DESC,
  PROD_MJR_CD,
  PROD_MNR_CD,
  PROD_MNR_DESC,
  CUST_CURR_CD,
  PROD_MJR_DESC,
  LIST_PRICE,
  LIST_PRICE_NEW,
  APO_GTS,
  EXCH_RATE,
  SALES_GRP_DESC,
  ACTUAL_QTY,
  ACTUAL_GTS,
  ACTUAL_NTS,
  PROJECTED_GTS,
  PROJECTED_NTS,
  PROJECTED_QTY,
  PX_GTS,
  PX_NTS,
  PX_QTY,
  BP_GTS,
  BP_NTS,
  BP_QTY,
  BRANDCON_MAPPING_FINAL,
  BRANDCON_MAPPING_SUMMARY,
  BRAND_SC,
  STRONGHOLD_V3,
  UPDATE_DATE,
  CURRENT_JJ_MONTH,
  CURRENT_JJ_YEAR 
)
FROM @PROD_DNA_LOAD.THASDL_RAW.PROD_LOAD_STAGE_ADLS/prd/eCOM_Data/transaction/old_schema/
FILE_FORMAT = (TYPE = CSV FIELD_DELIMITER = ','  SKIP_HEADER = 1 FIELD_OPTIONALLY_ENCLOSED_BY = '\"' ENCODING = 'ISO-8859-1');
